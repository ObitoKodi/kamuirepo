import base64;exec base64.b64decode('IiIiCiAgICBwYXNzd29yZC5weSAtLS0gSmVuIFBsdWdpbiBmb3IgcHJvdGVjdGluZyBzb21lIHNlY3Rpb25zIHdpdGggYSBwYXNzd29yZAogICAgQ29weXJpZ2h0IChDKSAyMDE4LCBNaXN0ZXItWAoKICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgICBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQogICAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3IKICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgogICAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogICAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQogICAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCiAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICAgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCgoKICAgIFVzYWdlIEV4YW1wbGVzOgoJPGRpcj4KCQk8dGl0bGU+VEhFIE5BTUUgT0YgWU9VUiBTRUNUSU9OPC90aXRsZT4KCQk8bGluaz5USEUgTElOSyBPRiBZT1VSIFhNTDwvbGluaz4KCQk8cGFzc3dvcmQ+Z2V0L0JBU0U2NCBDT0RFPC9wYXNzd29yZD4KCQk8dGh1bWJuYWlsPlRIVU1CTkFJTDwvdGh1bWJuYWlsPgoJPC9kaXI+CiIiIgoKaW1wb3J0IHVybGxpYiwgdXJsbGliMiwgb3MsIGJhc2U2NCwgeGJtY3BsdWdpbiwgeGJtY2d1aSwgeGJtY3ZmcywgdHJhY2ViYWNrLCBjb29raWVsaWIsIHhibWMsIHN5cywgYmFzZTY0CmltcG9ydCBwaWNrbGUKaW1wb3J0IHRpbWUKaW1wb3J0IHJlCmltcG9ydCBrb2RpbmcKaW1wb3J0IHhibWNhZGRvbgpmcm9tIGtvZGluZyBpbXBvcnQgcm91dGUKZnJvbSByZXNvdXJjZXMubGliLnBsdWdpbiBpbXBvcnQgUGx1Z2luCmZyb20gcmVzb3VyY2VzLmxpYi51dGlsLmNvbnRleHQgaW1wb3J0IGdldF9jb250ZXh0X2l0ZW1zCmZyb20gcmVzb3VyY2VzLmxpYi51dGlsLnhtbCBpbXBvcnQgSmVuSXRlbSwgSmVuTGlzdCwgZGlzcGxheV9saXN0CmZyb20gdW5pZGVjb2RlIGltcG9ydCB1bmlkZWNvZGUKCgphZGRvbl9mYW5hcnQgPSB4Ym1jYWRkb24uQWRkb24oKS5nZXRBZGRvbkluZm8oJ2ZhbmFydCcpCmFkZG9uX2ljb24gPSB4Ym1jYWRkb24uQWRkb24oKS5nZXRBZGRvbkluZm8oJ2ljb24nKQoKCmNsYXNzIFBBU1NXT1JEKFBsdWdpbik6CiAgICBuYW1lID0gIm1hdmVyaWNrIgoKICAgIGRlZiBwcm9jZXNzX2l0ZW0oc2VsZiwgaXRlbV94bWwpOgogICAgICAgIGlmICI8cGFzc3dvcmQ+IiBpbiBpdGVtX3htbDoKCQkJaXRlbSA9IEplbkl0ZW0oaXRlbV94bWwpCgkJCWlmICJnZXQvIiBpbiBpdGVtLmdldCgicGFzc3dvcmQiLCAiIik6CgkJCQlyZXN1bHRfaXRlbSA9IHsKCQkJCQknbGFiZWwnOiBpdGVtWyJ0aXRsZSJdLAoJCQkJCSdpY29uJzogaXRlbS5nZXQoInRodW1ibmFpbCIsIGFkZG9uX2ljb24pLAoJCQkJCSdmYW5hcnQnOiBpdGVtLmdldCgiZmFuYXJ0IiwgYWRkb25fZmFuYXJ0KSwKCQkJCQknbW9kZSc6ICJzaG93aW5nIiwKCQkJCQkndXJsJzogaXRlbS5nZXQoImxpbmsiLCAiIikgKyAnICcgKyBpdGVtLmdldCgicGFzc3dvcmQiLCAiIiksCgkJCQkJJ2ZvbGRlcic6IFRydWUsCgkJCQkJJ2NvbnRlbnQnOiAiZmlsZXMiLAoJCQkJCSdpbmZvJzoge30sCgkJCQkJJ3llYXInOiAiMCIsCgkJCQkJJ2NvbnRleHQnOiBnZXRfY29udGV4dF9pdGVtcyhpdGVtKSwKCQkJCQkic3VtbWFyeSI6IGl0ZW0uZ2V0KCJzdW1tYXJ5IiwgTm9uZSkKCQkJCX0KCQkJCXJlc3VsdF9pdGVtWyJwcm9wZXJ0aWVzIl0gPSB7CgkJCQkJJ2ZhbmFydF9pbWFnZSc6IHJlc3VsdF9pdGVtWyJmYW5hcnQiXQoJCQkJfQoJCQkJcmVzdWx0X2l0ZW1bJ2ZhbmFydF9zbWFsbCddID0gcmVzdWx0X2l0ZW1bImZhbmFydCJdCgkJCQlyZXR1cm4gcmVzdWx0X2l0ZW0KCQkJCQoJCQpAcm91dGUobW9kZT0nc2hvd2luZycsIGFyZ3M9WyJ1cmwiXSkKZGVmIHNob3dpbmcodXJsKToKCXhtbCA9ICcnCglzdHJpbmcgPSB1cmwuc3BsaXQoKQoJVGhlWG1sLFRoZUNvZGUgPSBzdHJpbmdbMF0sc3RyaW5nWzFdCglUaGVDb2RlID0gVGhlQ29kZS5yZXBsYWNlKCJnZXQvIiwiIikKCVRoZUNvZGUgPSBiYXNlNjQuYjY0ZGVjb2RlKFRoZUNvZGUpCglpbnB1dCA9ICcnCglrZXlib2FyZCA9IHhibWMuS2V5Ym9hcmQoaW5wdXQsICdbQ09MT1IgcmVkXVBhc3N3b3JkIElzIEF2YWlsYWJsZSBGcm9tIE91ciBUZWxlZ3JhbSBHcm91cCA6LSlbL0NPTE9SXScpCglrZXlib2FyZC5kb01vZGFsKCkKCWlmIGtleWJvYXJkLmlzQ29uZmlybWVkKCk6CgkJaW5wdXQgPSBrZXlib2FyZC5nZXRUZXh0KCkKCWlmIGlucHV0ID09IFRoZUNvZGU6IAoJCWxpc3RodG1sID0gZ2V0SHRtbChUaGVYbWwpCgkJbWF0Y2ggPSByZS5jb21waWxlKAoJCQkJJyhbXiJdKyknLCAKCQkJCXJlLklHTk9SRUNBU0UgfCByZS5ET1RBTEwpLmZpbmRhbGwobGlzdGh0bWwpCgkJZm9yIHhtbENvbnRlbnQgaW4gbWF0Y2g6CgkJCXhtbCArPSB4bWxDb250ZW50CgllbHNlOgoJCXhtbCArPSAiPGRpcj4iXAoJCQkgICAiPHRpdGxlPltDT0xPUiByZWRdV3JvbmcgQW5zd2VyLCBEdWRlLi4uWy9DT0xPUl08L3RpdGxlPiJcCgkJCSAgICI8dGh1bWJuYWlsPmh0dHBzOi8vbnN4Lm5wLmRsLnBsYXlzdGF0aW9uLm5ldC9uc3gvbWF0ZXJpYWwvYy9jZTQzMmUwMGNlOTdhNDYxYjlhOGMwMWNlNzg1MzhmNGZhNjYxMGZlLTExMDc1NjIucG5nPC90aHVtYm5haWw+IlwKCQkJICAgIjwvZGlyPiIKCWplbmxpc3QgPSBKZW5MaXN0KHhtbCkKCWRpc3BsYXlfbGlzdChqZW5saXN0LmdldF9saXN0KCksIGplbmxpc3QuZ2V0X2NvbnRlbnRfdHlwZSgpKQoKCgpkZWYgZ2V0SHRtbCh1cmwsIHJlZmVyZXI9Tm9uZSwgaGRyPU5vbmUsIGRhdGE9Tm9uZSk6CiAgICBVU0VSX0FHRU5UID0gJ01vemlsbGEvNS4wIChXaW5kb3dzOyBVOyBXaW5kb3dzIE5UIDUuMTsgZW4tR0I7IHJ2OjEuOS4wLjMpIEdlY2tvLzIwMDgwOTI0MTcgRmlyZWZveC8zLjAuMycKICAgIGhlYWRlcnMgPSB7J1VzZXItQWdlbnQnOiBVU0VSX0FHRU5ULAogICAgICAgICAgICdBY2NlcHQnOiAnKi8qJywKICAgICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJ30KICAgIGlmIG5vdCBoZHI6CiAgICAgICAgcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgZGF0YSwgaGVhZGVycykKICAgIGVsc2U6CiAgICAgICAgcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCwgZGF0YSwgaGRyKQogICAgaWYgcmVmZXJlcjoKICAgICAgICByZXEuYWRkX2hlYWRlcignUmVmZXJlcicsIHJlZmVyZXIpCiAgICByZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbihyZXEsIHRpbWVvdXQ9NjApCiAgICBkYXRhID0gcmVzcG9uc2UucmVhZCgpICAgIAogICAgcmVzcG9uc2UuY2xvc2UoKQogICAgcmV0dXJuIGRhdGE=')